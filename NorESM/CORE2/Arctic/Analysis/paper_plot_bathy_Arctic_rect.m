clear all

h=gebco;
h1=0.5*(h(1:end-1,:)+h(2:end,:));

h2(1:2:47,:)=h;
h2(2:2:46,:)=h1;

C = [-5000.0 -4000.0 -3000.0 -2500.0 -2000.0 ...
     -1500.0 -1000.0  -500.0  -200.0  -100.0 ...
       -50.0   -25.0   -10.0     0.0    50.0 ...
       100.0   200.0   300.0   400.0   500.0 ...
       600.0   700.0   800.0  1000.0];

C1=0.5*(C(1,1:end-1)+C(1,2:end));

C2(:,1:2:47)=C;
C2(:,2:2:46)=C1;

%filename='~/matlab/roms_tools/bathymetry/etopo5.nc';
%lon=nc_varget(filename,'topo_lon');                   
%lat=nc_varget(filename,'topo_lat');
%topo=nc_varget(filename,'topo');   
filename='ETOPO2v2g_f4.nc';
lon=nc_varget(filename,'x');
lat=nc_varget(filename,'y');
topo=nc_varget(filename,'z');
lat(end+1)=lat(end-1);
topo(end+1,:)=topo(end-1,:);


sk=10;
figure
set(gcf, 'units', 'centimeters', 'pos', [10 10 25 25])
%m_proj('Azimuthal Equidistant','lat',85,'long',-45,'radius',40,'rec','on');
%m_proj('stereographic','lat',90,'long',0,'radius',35,'rec','on');
m_proj('stereographic','lat',90,'long',0,'radius',30.2);
mask=topo;
mask(mask<0)=NaN;
topo(topo>=0)=NaN;

x=lon(1:sk:end);
y=lat(1:sk:end);
fld=topo(1:sk:end,1:sk:end);

b=[230 255 255; 
200 245 255;
%210 250 255;
180 245 255;
160 240 255; 
100 180 255;
%80 180 255; 
40 150 255; 
30 110 250; 
10 50 200; 
10 50 160;
10 50 120]./255;

cv=[-4000 -3500 -3000 -2500 -2000 -1500 -1000 -500 -250 -50 0];
%cv=[-4000 -3500 -3000 -2500 -2000 -1500 -1000 -750 -500 -250 0];
hold on
colormap(flipud(b))
%[c,h]=m_contourf(x,y,-fld,[-cv(1) inf],'linecolor','none');
%set(findobj(h,'type','patch'),'facecolor','flat','cdata',-inf);               
%[c,hc]=m_contourf(x,y,fld,cv,'linecolor','none');   
[c,hc]=m_contourf(x,y,fld,[-5500 cv],'linecolor','none');   
hb=cbarfmb([cv(1) 0],cv,'horizontal','nonlinear'); 
%hb=cbarfmb([-inf 0],cv,'vertical','nonlinear'); 
%hb=cbarfmb([-inf inf],cv,'vertical','nonlinear'); 
cdatamidlev([hc;hb],cv,'nonlinear');  
caxis([cv(1) cv(end)])                                                        
caxis(hb,[cv(1) cv(end)])  
m_grid('xtick',[-180:45:180],'tickdir','out','ytick',[70 80 85],'yticklabels',['';'';''],'linest','-');
m_gshhs_l('patch',[1 1 1],'edgecolor','k')
%m_coast('patch',[1 1 1],'edgecolor','k')


return
hhh=m_pcolor(lon(1:sk:end),lat(1:sk:end),mask(1:sk:end,1:sk:end));shading interp;
hold on
m_pcolor(lon(1:sk:end),lat(1:sk:end),topo(1:sk:end,1:sk:end));shading interp;colorbar
caxis([-4500 0])
%colormap(h2(1:24,:))
colormap(h2(1:2:24,:))
set(hhh,'facecolor',[.7 .7 .7]);
%hold on
%m_gshhs_l('patch',[.7 .7 .7])

return
lon_s3=[-18.5:2:14];
lat_s3=[79.5]*ones(1,length(lon_s3));
%lon_s4=[  13.0   12.0    8.0    4.0    4.0   10.0   20.0   30.0   40.0   50.0   60.0   70.0   80.0   90.0  100.0  110.0  120.0  130.0  140.0];
%lat_s4=[  75.0   76.0   78.0   79.0   80.0   81.0   81.8   81.8   82.6   83.0   83.2   83.1   82.8   82.5   81.8   79.7   78.2   78.2   79.7];
lon_s4=[17.6 16.5 16.05 15.6 15.1 14.1 13.0   12.0  10.0  8.0    4.0    4.0   10.0   20.0   30.0   40.0   50.0   60.0   70.0   80.0   90.0  100.0  110.0  120.0  130.0  140.0];
lat_s4=[69   70.6 71.3  72.02 72.8 73.8 75.0   76.0 77.0  78.0   79.0   80.0   81.0   81.8   81.8   82.6   83.0   83.2   83.1   82.8   82.5   81.8   79.7   78.2   78.2   79.7];
lon_s5=[17.4 17.2 17.7 17.6 17.5 18.0 18.15 18.3 18.5 18.7 18.9 19.0 19.2 19.4 19.5 19.6 19.65];
lat_s5=[76.8 76.3 75.8 75.4 75.0 74.5 74.0 73.75 73.25 72.8 72.35 71.9 71.4 71.0 70.6 70.3 70.0];
lon_s5=fliplr(lon_s5);
lat_s5=fliplr(lat_s5);
%m_grid
%m_grid('xtick',[-120 -60 0 60 120])
m_grid('xtick',[-135:45:135],'ytick',[60 70 80])
hold on
x=[ -103.84775688995
         -132.426110480092
          -146.32851987161
         -157.129445685198
         -165.289764266082
         -174.948859566318
         -169.908721619095
          -153.99152252417
         -153.654033773183
         -155.991549118887
         -157.264115189183
          -158.99374858648
         -156.200224800736
         -149.147691533142
         -146.758355108426
         -144.575059890815
         -142.121921555256
         -140.683340702781
         -138.653559249327
         -137.204255767801
          -134.56804180152
         -129.946421652944
         -127.799470427715
         -127.884540272314
         -127.978284839156
         -127.025389763871
          -120.96578199099
         -110.556210660899
         -109.124896536309
         -108.367743820184
          -105.94954447772
          -103.84775688995];

y=[       83.1681125452104
          83.7662334620532
          83.8235854688569
          83.8506192123663
          83.5387740470199
          81.0961814080998
            79.63568188243
          77.4297453757112
          76.9425777887249
          76.1151804105261
          74.9362263809805
          73.5789329669126
          72.8750577746576
          71.4351508667292
          71.0889175071879
          71.0180792528114
          70.7030506843364
          70.6869725167624
          70.4111375153443
          70.4316926024079
          70.6888027417022
          71.8499446192718
          72.9555979284964
          73.7334233896998
          74.5127217931511
          75.3222606599783
          77.8864195154148
          80.0342652352252
          80.3858803567825
            81.84979009224
           82.139759675712
          83.1681125452104];

m_plot(x,y,'r','linewidth',2)

% Euroasian basin
x=[27.2474628708497
          36.5447032085722
          48.5214896162041
          60.7001380803934
          77.9434238049383
          94.8206611280039
          107.876624193844
           114.76253701556
          121.721644200227
          134.412781688966
          140.650432725167
          141.964704250335
          145.155248340791
          149.246374638137
          132.143273251575
           149.76109018589
         -79.6880622455017
           -55.18591213471
         -43.4591200137502
         -22.0049915144465
         -20.6758818057775
         -17.5930251981611
         -9.73692516655174
          5.28638472739742
          27.2474628708497];
y=[      81.2047365447009
          81.5007859895957
          82.2436675361916
           82.721919243158
          82.4532187163616
          81.6658524321853
          80.1201616988957
           78.868040305759
          77.3745806589471
           78.343810419039
          79.2198008825623
          81.0361747596064
          82.8850251870597
          84.6970166179212
           88.170272215848
          88.5112003265041
          89.0201530656119
            86.82607324433
          85.3307236364029
          85.7137862915936
          84.4424860812103
          83.6275436815664
          82.8313390219846
          82.2610471668164
          81.2047365447009];

m_plot(x,y,'g','linewidth',2)


m_plot(lon_s3,lat_s3,'k','linewidth',2)
m_plot([-110 70],[70 70],'k','linewidth',2)
m_plot(lon_s4,lat_s4,'k','linewidth',2)
m_plot(lon_s5,lat_s5,'k','linewidth',2)
%m_plot([-50 -63],[66.5 66.5],'k','linewidth',2)
%m_plot([-167.5 -171],[65.8 65.8],'k','linewidth',2)
m_text(-31,79,'FS','fontsize',14);
m_text(18.6,70,'BSO','fontsize',14);
m_text(145,78,'(S2)','fontsize',14);
m_text(72,70,'(S1)','fontsize',14);
%m_text(-47,66,'DS','fontsize',14);
%m_text(-172,66,'BS','fontsize',14);
m_text(-140,76,'CB','color','r','fontsize',14)
m_text(0,88,'EB','color','g','fontsize',14)
m_text(-165,60,'Bering Strait','color','w','fontsize',10)
m_text(40,80,'Barents Sea','color','w','fontsize',11)
m_text(-62,68,{'Davis','Strait'},'color','w','fontsize',10)
m_text(84,82.4,'SAT','color','w','fontsize',10)
m_text(88,80,'Kara Sea','color','w','fontsize',11)
m_text(132,76,{'Laptev','  Sea'},'color','w','fontsize',11)
m_text(-169,68,{'Chuckchi','  Sea'},'color','w','fontsize',11)
m_text(10,80,'Svalbard','color','w','fontsize',11)
m_text(5,82,'YP','color','w','fontsize',9)


set(gcf,'color','w');
set(gcf,'inverthardcopy','off')

%break
export_fig(1,'dnm','-eps','-r150');



